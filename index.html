<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitor de Competencia (Compartido)</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React + Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Fuente Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
        body { 
            background-color: #050505; 
            color: white; 
            font-family: 'Inter', sans-serif; 
            overflow-x: hidden;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255,255,255,0.02); }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.15); border-radius: 10px; }
        
        .loader-container { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: #000; z-index: 9999; transition: opacity 0.5s; }
        .spinner { width: 40px; height: 40px; border: 4px solid rgba(255,255,255,0.1); border-left-color: #ec4899; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .fade-out { opacity: 0; pointer-events: none; }
        
        .glass-panel {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        /* Animación Magia */
        @keyframes magic-pulse {
            0% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(236, 72, 153, 0); }
            100% { box-shadow: 0 0 0 0 rgba(236, 72, 153, 0); }
        }
        .magic-btn:hover { animation: magic-pulse 1s infinite; }
    </style>
</head>
<body>

    <div id="loader" class="loader-container">
        <div class="text-center">
            <div class="spinner mb-4 mx-auto"></div>
            <p class="text-white/40 text-xs tracking-[0.3em] uppercase font-bold">Conectando Sistema</p>
        </div>
    </div>

    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useMemo } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        import { 
            TrendingUp, School, GraduationCap, CalendarClock, Database, Wifi, 
            WifiOff, Plus, Save, X, DollarSign, CreditCard, Eye, MessageCircleHeart, 
            FileSignature, MapPin, Phone, Percent, Calculator, ThumbsUp, ThumbsDown, 
            Pencil, User, Clock, Trash2, CloudOff, Layers, Users, AlertTriangle, Sparkles, Download
        } from 'https://esm.sh/lucide-react@0.344.0';
        
        import { initializeApp } from 'https://esm.sh/firebase@10.8.0/app';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://esm.sh/firebase@10.8.0/auth';
        import { getFirestore, collection, doc, setDoc, onSnapshot } from 'https://esm.sh/firebase@10.8.0/firestore';

        const firebaseConfig = {
            apiKey: "AIzaSyAUhd2TlP1-RLnfXFPhZUcGGC1mJ4IBMWw",
            authDomain: "monitorcompetencia.firebaseapp.com",
            projectId: "monitorcompetencia",
            storageBucket: "monitorcompetencia.firebasestorage.app",
            messagingSenderId: "302198704198",
            appId: "1:302198704198:web:6ed2d4df49ebdec0fea247",
            measurementId: "G-QN3FERMGT0"
        };

        let app, auth, db;
        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (e) { console.error("Firebase Init Error", e); }

        setTimeout(() => {
            const loader = document.getElementById('loader');
            if(loader) loader.classList.add('fade-out');
        }, 1500);

        const getDominantColor = (imageSrc) => {
            return new Promise((resolve) => {
                const img = new Image();
                img.crossOrigin = "Anonymous";
                img.src = imageSrc;
                img.onload = () => {
                    try {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = 1;
                        canvas.height = 1;
                        ctx.drawImage(img, 0, 0, 1, 1);
                        const [r, g, b] = ctx.getImageData(0, 0, 1, 1).data;
                        resolve(`rgb(${r},${g},${b})`);
                    } catch (e) { resolve(null); }
                };
                img.onerror = () => resolve(null);
            });
        };

        const INSTITUTIONS_DB = [
            { name: "Santo Domingo", color: "#0d9488", logo: "https://i.postimg.cc/8fHH5TZg/Santo-Domingo.png" }, 
            { name: "IES", color: "#38bdf8", logo: "https://i.postimg.cc/brSB0bGz/IES.png" }, 
            { name: "Siglo 21", color: "#14532d", logo: "https://i.postimg.cc/hQrrjK2q/Siglo-21.png" }, 
            { name: "CEBA", color: "#be185d", logo: "https://i.postimg.cc/PJvRbZC7/Ceba.png" }, 
            { name: "Saber", color: "#1d4ed8", logo: "https://i.postimg.cc/F1tnTRcK/Saber.png" }, 
            { name: "BAC", color: "#78350f", logo: "https://i.postimg.cc/SRYvL8nH/BAC_Spinoza.png" }, 
            { name: "I. Superior Pascal", color: "#7f1d1d", logo: "https://i.postimg.cc/hvQ58xJD/IS_Pascal.png" }, 
            { name: "Undef", color: "#0284c7", logo: "https://i.postimg.cc/n9kkzn3r/UNDEF.png" }, 
            { name: "Teclab", color: "#60a5fa", logo: "https://i.postimg.cc/jnXX5RMT/Tec-Lab.png" }, 
            { name: "Aeronáutico", color: "#eab308", logo: "https://i.postimg.cc/mD5nFVgv/Aeronautico.png" }, 
            { name: "Fasta", color: "#1e3a8a", logo: "https://i.postimg.cc/90wnPT42/Fasta.png" }, 
            { name: "UTN", color: "#4b5563", logo: "https://i.postimg.cc/jnXX5RMw/UTN.png" }, 
            { name: "Iscet", color: "#f97316", logo: "https://i.postimg.cc/8cf0dWF5/ISCET.png" }, 
            { name: "Kennedy", color: "#881337", logo: "https://i.postimg.cc/1VPBs8rS/Kennedy.png" }, 
            { name: "CUP", color: "#ea580c", logo: "https://i.postimg.cc/R3B2NZRh/CUP.png" }, 
            { name: "Católica", color: "#1e40af", logo: "https://i.postimg.cc/NKTWsH1L/Catolica.png" }, 
            { name: "Cervantes", color: "#1d4ed8", logo: "https://i.postimg.cc/1XVj0682/Cervantes.png" }
        ];

        const EMPTY_CAREER = {
            id: null,
            carrera: '', matricula: '', cuota: '',
            cantidadCuotas: '', valorSemestre: '', promocion: '', mediosPago: '',
            atencion: '', observacion: '', modalidad: '',
            destacadoPositivo: '', destacadoNegativo: ''
        };

        function CompetitorApp() {
            const [user, setUser] = useState(null);
            const [competitorData, setCompetitorData] = useState({});
            const [demoMode, setDemoMode] = useState(false);
            const [connectionError, setConnectionError] = useState(null);
            
            const [selectedInst, setSelectedInst] = useState(null);
            const [isEditing, setIsEditing] = useState(false);
            const [isAddingNew, setIsAddingNew] = useState(false);
            const [dynamicColors, setDynamicColors] = useState({});
            const [currentCareerIndex, setCurrentCareerIndex] = useState(0);
            const [showMagicPaste, setShowMagicPaste] = useState(false);
            const [magicText, setMagicText] = useState("");

            const [formData, setFormData] = useState({
                direccion: '', contacto: '', responsable: '',
                customFields: [],
                careers: [] 
            });

            const [newInstData, setNewInstData] = useState({ name: '', logo: '', color: '#ec4899' });

            // --- AUTH ---
            useEffect(() => {
                if (!auth) { 
                    setDemoMode(true); 
                    setConnectionError("Error Crítico: Firebase no inicializado.");
                    return; 
                }
                const unsubAuth = onAuthStateChanged(auth, (u) => { 
                    if (u) { setUser(u); if(!demoMode) setConnectionError(null); }
                });
                signInAnonymously(auth).catch((e) => {
                    console.warn("Auth error:", e);
                    setDemoMode(true);
                    if (e.code === 'auth/admin-restricted-operation' || e.code === 'auth/operation-not-allowed') {
                        setConnectionError("FALTA ACTIVAR AUTH ANÓNIMO EN LA CONSOLA");
                    } else {
                        setConnectionError("Dominio no autorizado en Firebase");
                    }
                });
                return () => unsubAuth();
            }, []);

            // --- DATA ---
            useEffect(() => {
                if (demoMode) {
                    const saved = localStorage.getItem('competitor_data_shared');
                    if (saved) setCompetitorData(JSON.parse(saved));
                    return;
                }
                if (!db) return;
                
                try {
                    const q = collection(db, 'base_datos_compartida');
                    const unsubData = onSnapshot(q, (snap) => {
                        const d = {};
                        snap.forEach((doc) => d[doc.id] = doc.data());
                        setCompetitorData(d);
                        setDemoMode(false);
                        setConnectionError(null);
                    }, (err) => {
                        console.warn("Error DB:", err);
                        setDemoMode(true);
                        if (err.code === 'permission-denied') {
                            setConnectionError("ERROR DE PERMISOS: Revisa las Reglas en Firebase.");
                        }
                    });
                    return () => unsubData();
                } catch (e) { setDemoMode(true); }
            }, [user, demoMode]);

            // --- COLORES ---
            useEffect(() => {
                const run = async () => {
                    const cols = {};
                    for (const inst of INSTITUTIONS_DB) {
                        if (inst.logo && !dynamicColors[inst.name]) {
                            const c = await getDominantColor(inst.logo);
                            if (c) cols[inst.name] = c;
                        }
                    }
                    setDynamicColors(p => ({...p, ...cols}));
                };
                run();
            }, []);

            const mergedInstitutions = useMemo(() => {
                const list = [...INSTITUTIONS_DB];
                Object.keys(competitorData).forEach(k => {
                    if (!list.find(i => i.name === k)) list.push({ name: k, color: competitorData[k].customColor || '#555', logo: competitorData[k].customLogo, isCustom: true });
                });
                return list;
            }, [competitorData]);

            // --- FUNCIONALIDAD EXCEL ---
            const exportExcel = () => {
                const cervantesData = competitorData['Cervantes'];
                // Obtener todas las carreras de Cervantes para comparar
                const cervantesCareers = cervantesData?.careers || [];
                const defaultBaseline = cervantesCareers.length > 0 ? cervantesCareers[0] : null;

                // Helper para calcular valor semestre
                const getSemestreVal = (c) => {
                    if (!c) return 0;
                    if (c.valorSemestre && parseFloat(c.valorSemestre) > 0) return parseFloat(c.valorSemestre);
                    if (c.cuota && c.cantidadCuotas) return parseFloat(c.cuota) * parseFloat(c.cantidadCuotas);
                    return 0;
                };

                const rows = [];
                // Header
                rows.push(['Institución', 'Carrera', 'Modalidad', 'Matrícula ($)', 'Cuota ($)', 'Cant. Cuotas', 'Semestre ($)', 'Comparación vs Cervantes', 'Responsable']);

                // Recorrer todas las instituciones
                mergedInstitutions.forEach(inst => {
                    const data = competitorData[inst.name];
                    if (!data) return;

                    const careers = data.careers && data.careers.length > 0 ? data.careers : [data]; // Fallback legacy

                    careers.forEach(career => {
                        if (!career.carrera && !career.matricula && !career.cuota) return; // Skip empty

                        const semVal = getSemestreVal(career);
                        let comparisonText = "-";
                        let colorStyle = ""; // Para lógica interna, en CSV no se ve color pero en XML/HTML sí.

                        // Buscar carrera equivalente en Cervantes
                        let baseline = cervantesCareers.find(c => c.carrera?.trim().toLowerCase() === career.carrera?.trim().toLowerCase());
                        if (!baseline) baseline = defaultBaseline;

                        if (inst.name !== 'Cervantes' && baseline) {
                            const baseVal = getSemestreVal(baseline);
                            if (baseVal > 0 && semVal > 0) {
                                if (semVal > baseVal) {
                                    comparisonText = "Más CARO que Cervantes";
                                    colorStyle = "background-color:#C6EFCE; color:#006100;"; // Verde (Competencia cara = Bueno para nosotros)
                                } else if (semVal < baseVal) {
                                    comparisonText = "Más BARATO que Cervantes";
                                    colorStyle = "background-color:#FFC7CE; color:#9C0006;"; // Rojo (Competencia barata = Malo para nosotros)
                                } else {
                                    comparisonText = "Igual que Cervantes";
                                }
                            }
                        }

                        rows.push({
                            cells: [
                                inst.name,
                                career.carrera || '-',
                                career.modalidad || '-',
                                career.matricula || '-',
                                career.cuota || '-',
                                career.cantidadCuotas || '-',
                                semVal || '-',
                                comparisonText,
                                data.responsable || '-'
                            ],
                            style: colorStyle
                        });
                    });
                });

                // Generar HTML para Excel (Truco para colores)
                let table = `
                    <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                    <head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Competencia</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta charset="UTF-8"></head>
                    <body>
                    <table border="1">
                        <thead>
                            <tr style="background-color: #444; color: white;">
                                ${rows[0].map(h => `<th>${h}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${rows.slice(1).map(row => `
                                <tr>
                                    ${row.cells.map((c, i) => {
                                        // Aplicar estilo solo a la columna de comparación (índice 7) o a toda la fila? 
                                        // El usuario pidió "pinten de verde los que tengan el semestre...", pintaremos la celda de comparación o toda la fila.
                                        // Pintemos la celda de comparación para que sea claro.
                                        const style = (i === 7 && row.style) ? ` style="${row.style}"` : '';
                                        return `<td${style}>${c}</td>`;
                                    }).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    </body></html>
                `;

                const blob = new Blob([table], { type: 'application/vnd.ms-excel' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Relevamiento_Competencia_${new Date().toISOString().split('T')[0]}.xls`;
                a.click();
            };

            // --- PEGAR MÁGICO ---
            const handleMagicPaste = () => {
                if (!magicText.trim()) return;
                const text = magicText;
                const lines = text.split(/\n+/);
                const newValues = {};
                let fullTextLower = text.toLowerCase();

                if (fullTextLower.includes('online') || fullTextLower.includes('virtual')) newValues.modalidad = '100% Online';
                else if (fullTextLower.includes('hibrid') || fullTextLower.includes('semipresencial')) newValues.modalidad = 'Híbrida';
                else if (fullTextLower.includes('presencial')) newValues.modalidad = 'Presencial';

                const promoMatch = fullTextLower.match(/(\d+%\s?(off|descuento|bonific)|bonificaci[óo]n.*)/i);
                if (promoMatch) newValues.promocion = promoMatch[0];

                if (fullTextLower.includes('tarjeta') || fullTextLower.includes('transferencia') || fullTextLower.includes('efectivo')) {
                    newValues.mediosPago = "Transferencia / Tarjeta / Efectivo";
                }

                lines.forEach(line => {
                    const lineLower = line.toLowerCase();
                    const priceMatch = line.match(/(\$|u\$s)?\s?([1-9]\d{0,2}(\.\d{3})+)/); 
                    if (priceMatch) {
                        const rawNumber = priceMatch[0].replace(/[^0-9]/g, '');
                        if (lineLower.includes('matr') || lineLower.includes('inscrip')) newValues.matricula = rawNumber;
                        else if (lineLower.includes('semestre') && (lineLower.includes('completo') || lineLower.includes('total') || lineLower.includes('valor del semestre'))) newValues.valorSemestre = rawNumber;
                        else if ((lineLower.includes('cuota') || lineLower.includes('mes') || lineLower.includes('mensual')) && !newValues.cuota) newValues.cuota = rawNumber;
                    }
                    const quotaCountMatch = lineLower.match(/(\d{1,2})\s*cuotas/);
                    if (quotaCountMatch) newValues.cantidadCuotas = quotaCountMatch[1];
                });

                if (!newValues.observacion && text.length > 20) newValues.observacion = "Texto original pegado: " + text.substring(0, 100) + "...";
                const newCareers = [...formData.careers];
                newCareers[currentCareerIndex] = { ...newCareers[currentCareerIndex], ...newValues };
                setFormData({ ...formData, careers: newCareers });
                setMagicText("");
                setShowMagicPaste(false);
            };

            // --- HANDLERS ---
            const handleCardClick = (inst) => {
                const d = competitorData[inst.name] || {};
                let careersList = [];
                if (d.careers && Array.isArray(d.careers) && d.careers.length > 0) careersList = d.careers;
                else if (d.carrera || d.matricula) {
                    careersList = [{ ...EMPTY_CAREER, id: Date.now(), ...d }];
                } else {
                    careersList = [{ ...EMPTY_CAREER, id: Date.now() }];
                }
                const savedUser = d.responsable || lastUser || '';
                setFormData({
                    direccion: d.direccion || '', contacto: d.contacto || '', responsable: savedUser,
                    customFields: d.customFields || [], careers: careersList
                });
                setCurrentCareerIndex(0);
                setSelectedInst(inst);
                setIsEditing(false);
            };

            const handleSave = async () => {
                if (!selectedInst) return;
                const cleanedCareers = formData.careers.filter((c, i) => i === 0 || c.carrera.trim() !== '');
                const newData = { 
                    ...formData, careers: cleanedCareers,
                    carrera: cleanedCareers[0]?.carrera || '', matricula: cleanedCareers[0]?.matricula || '', cuota: cleanedCareers[0]?.cuota || '',
                    lastUpdated: new Date().toISOString(), lastModifiedBy: user?.uid || 'anon',
                    ...(selectedInst.isCustom ? { customColor: selectedInst.color, customLogo: selectedInst.logo } : {}) 
                };
                if (formData.responsable) setLastUser(formData.responsable);
                const updated = { ...competitorData, [selectedInst.name]: newData };
                setCompetitorData(updated);
                if (demoMode) localStorage.setItem('competitor_data_shared', JSON.stringify(updated));
                else await setDoc(doc(db, 'base_datos_compartida', selectedInst.name), newData, { merge: true }).catch((err) => {
                    setDemoMode(true); localStorage.setItem('competitor_data_shared', JSON.stringify(updated));
                    alert("Error nube. Guardado local.");
                });
                setIsEditing(false);
            };

            const handleCreate = async () => {
                if (!newInstData.name) return;
                const newData = { 
                    lastUpdated: new Date().toISOString(), customColor: newInstData.color, 
                    customLogo: newInstData.logo, isCustom: true, careers: [{ ...EMPTY_CAREER, id: Date.now() }]
                };
                const updated = { ...competitorData, [newInstData.name]: newData };
                setCompetitorData(updated);
                if (demoMode) localStorage.setItem('competitor_data_shared', JSON.stringify(updated));
                else await setDoc(doc(db, 'base_datos_compartida', newInstData.name), newData).catch(() => {
                    setDemoMode(true); localStorage.setItem('competitor_data_shared', JSON.stringify(updated));
                });
                setIsAddingNew(false); setNewInstData({ name: '', logo: '', color: '#ec4899' });
            };
            
            const updateCareerField = (field, value) => {
                const newCareers = [...formData.careers];
                newCareers[currentCareerIndex] = { ...newCareers[currentCareerIndex], [field]: value };
                setFormData({ ...formData, careers: newCareers });
            };
            const addNewCareer = () => {
                const newCareers = [...formData.careers, { ...EMPTY_CAREER, id: Date.now() }];
                setFormData({ ...formData, careers: newCareers });
                setCurrentCareerIndex(newCareers.length - 1);
            };
            const removeCareer = (e, index) => {
                e.stopPropagation();
                if (formData.careers.length === 1) return;
                const newCareers = formData.careers.filter((_, i) => i !== index);
                setFormData({ ...formData, careers: newCareers });
                setCurrentCareerIndex(0);
            };
            const addField = () => setFormData(p => ({...p, customFields: [...p.customFields, {label:'', value:''}]}));
            const updateField = (i, f, v) => { const u = [...formData.customFields]; u[i][f] = v; setFormData(p => ({...p, customFields: u})); };
            const removeField = (i) => setFormData(p => ({...p, customFields: p.customFields.filter((_, idx) => idx !== i)}));
            const formatDate = (iso) => iso ? new Date(iso).toLocaleString('es-AR', { timeZone: 'America/Argentina/Buenos_Aires', day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit' }) : 'Sin datos';
            const currentCareer = formData.careers[currentCareerIndex] || EMPTY_CAREER;

            return (
                <div className="min-h-screen w-full relative overflow-x-hidden text-white pb-20 font-sans">
                    <div className="fixed inset-0 z-0" style={{
                        backgroundImage: 'url("https://i.postimg.cc/6wfDzyN9/image.png")',
                        backgroundSize: 'cover', backgroundPosition: 'center', backgroundAttachment: 'fixed'
                    }}></div>
                    <div className="fixed inset-0 bg-black/50 z-0 pointer-events-none"></div>
                    
                    {connectionError && (
                        <div className="fixed top-0 left-0 w-full bg-red-600 text-white p-3 text-center z-50 font-bold text-sm flex items-center justify-center gap-2 shadow-lg animate-pulse">
                            <AlertTriangle size={20}/> {connectionError}
                        </div>
                    )}

                    <div className="relative z-10 container mx-auto px-4 pt-12">
                        {/* Header */}
                        <div className="glass-panel rounded-3xl p-6 shadow-2xl mb-10 flex flex-col md:flex-row justify-between items-center">
                            <div className="flex items-center gap-5">
                                <div className="w-14 h-14 bg-white/5 rounded-2xl flex items-center justify-center border border-white/10 shadow-inner">
                                    <TrendingUp size={28} className="text-white" />
                                </div>
                                <div>
                                    <h1 className="text-4xl font-black text-white uppercase tracking-tight leading-none drop-shadow-md">Benchmarking</h1>
                                    <p className="text-pink-400 font-bold text-sm tracking-[0.2em] uppercase mt-1">Competencia & Relevamiento</p>
                                </div>
                            </div>
                            <div className="mt-4 md:mt-0 flex flex-col items-end gap-2">
                                <div className="flex gap-2">
                                    {/* BOTÓN EXCEL */}
                                    <button onClick={exportExcel} className="bg-green-600/80 hover:bg-green-600 text-white px-4 py-2 rounded-xl border border-green-500/50 flex items-center gap-2 transition font-bold text-xs uppercase shadow-lg">
                                        <Download size={16}/> Descargar Excel
                                    </button>
                                    
                                    <div className="bg-black/40 px-6 py-2 rounded-xl border border-white/5">
                                        <p className="text-[10px] text-white/40 uppercase tracking-widest mb-1">Instituciones</p>
                                        <p className="text-2xl font-bold">{mergedInstitutions.length}</p>
                                    </div>
                                </div>
                                {demoMode ? (
                                    <div className="mt-2 inline-flex items-center gap-1 bg-red-500/20 text-red-300 px-2 py-1 rounded text-[10px] border border-red-500/30" title="Los datos no se están guardando en la nube. Revisa las reglas de Firebase.">
                                        <CloudOff size={12}/> Modo Local (No se comparte)
                                    </div>
                                ) : (
                                    <div className="mt-2 inline-flex items-center gap-1 bg-green-500/20 text-green-300 px-2 py-1 rounded text-[10px] border border-green-500/30">
                                        <Users size={12}/> Conectado (Compartido)
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Grid */}
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                            {mergedInstitutions.map((inst) => {
                                const data = competitorData[inst.name];
                                const hasData = data && data.lastUpdated;
                                const color = dynamicColors[inst.name] || inst.color;
                                const careerCount = data?.careers?.length || 0;

                                return (
                                    <div key={inst.name} onClick={() => handleCardClick(inst)} 
                                         className="group relative h-[240px] cursor-pointer transition-all duration-300 hover:-translate-y-2 perspective-1000">
                                        <div className="absolute inset-0 rounded-3xl border border-white/10 shadow-lg overflow-hidden transition-all duration-500 bg-[#111]/60 backdrop-blur-md"
                                             style={{ boxShadow: `0 10px 30px -10px rgba(0,0,0,0.8)` }}>
                                            <div className="absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-300" 
                                                 style={{ backgroundColor: color }}></div>
                                            <div className="relative z-10 p-6 flex flex-col h-full">
                                                <div className="flex items-center gap-4 mb-4">
                                                    <div className="w-14 h-14 shrink-0 relative filter drop-shadow-lg transition-transform group-hover:scale-110">
                                                        {inst.logo ? <img src={inst.logo} className="w-full h-full object-contain" /> : <School className="text-white/50 w-full h-full"/>}
                                                    </div>
                                                    <div className="flex-1 min-w-0">
                                                        <h3 className="text-xl font-bold text-white leading-tight truncate drop-shadow-md">{inst.name}</h3>
                                                        <p className="text-[10px] italic text-white/40 mt-1 group-hover:text-white/80">
                                                            {careerCount > 0 ? `${careerCount} Carrera(s)` : (hasData ? 'Sin carreras' : 'Sin datos')}
                                                        </p>
                                                    </div>
                                                </div>
                                                <div className="flex items-center gap-2 text-white/50 text-xs mb-auto group-hover:text-white/90">
                                                    <GraduationCap size={14} />
                                                    <span className="truncate">{data?.carrera ? data.carrera : 'Varios'}</span>
                                                </div>
                                                <div className="grid grid-cols-2 gap-3 mt-auto">
                                                    <div className="bg-white/5 rounded-lg p-3 border border-white/5 group-hover:border-white/20 group-hover:bg-black/20 transition-colors">
                                                        <p className="text-[9px] text-white/40 uppercase font-bold mb-1 group-hover:text-white/70">Matrícula</p>
                                                        <p className="text-sm font-bold text-white truncate">{data?.matricula ? `$${data.matricula}` : '-'}</p>
                                                    </div>
                                                    <div className="bg-white/5 rounded-lg p-3 border border-white/5 group-hover:border-white/20 group-hover:bg-black/20 transition-colors">
                                                        <p className="text-[9px] text-white/40 uppercase font-bold mb-1 group-hover:text-white/70">Cuota</p>
                                                        <p className="text-sm font-bold text-white truncate">{data?.cuota ? `$${data.cuota}` : '-'}</p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="absolute bottom-0 left-0 w-full h-[3px] transition-all group-hover:h-0" style={{ backgroundColor: color }}></div>
                                        </div>
                                    </div>
                                );
                            })}
                            <button onClick={() => setIsAddingNew(true)} className="h-[240px] rounded-3xl border-2 border-dashed border-white/10 flex flex-col items-center justify-center gap-3 text-white/30 hover:text-white hover:border-white/30 hover:bg-white/5 transition-all bg-black/20 backdrop-blur-sm">
                                <div className="w-12 h-12 rounded-full bg-white/5 flex items-center justify-center"><Plus size={24}/></div>
                                <span className="text-xs font-bold uppercase tracking-widest">Agregar Nueva</span>
                            </button>
                        </div>
                    </div>

                    {/* --- MODAL --- */}
                    {selectedInst && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200">
                            <div className="absolute inset-0 bg-black/90 backdrop-blur-xl" onClick={() => setSelectedInst(null)}></div>
                            <div className="relative w-full max-w-6xl rounded-[2rem] shadow-2xl flex flex-col max-h-[95vh] overflow-hidden border-2 transition-all"
                                 style={{ 
                                    backgroundColor: '#0a0a0a', 
                                    borderColor: dynamicColors[selectedInst.name] || selectedInst.color,
                                    boxShadow: `0 0 100px ${dynamicColors[selectedInst.name] || selectedInst.color}40`,
                                 }}>
                                <div className="absolute inset-0 pointer-events-none opacity-30" 
                                     style={{ background: `linear-gradient(135deg, ${dynamicColors[selectedInst.name] || selectedInst.color} 0%, transparent 100%)` }}>
                                </div>

                                <div className="relative p-8 border-b border-white/10 flex justify-between items-start backdrop-blur-sm z-10">
                                    <div className="flex gap-6 items-center">
                                        <div className="w-24 h-24 shrink-0 filter drop-shadow-2xl p-2 bg-white/5 rounded-2xl border border-white/10">
                                            {selectedInst.logo ? <img src={selectedInst.logo} className="w-full h-full object-contain" /> : <School className="text-white w-full h-full"/>}
                                        </div>
                                        <div>
                                            <h2 className="text-4xl font-black text-white tracking-tight drop-shadow-lg">{selectedInst.name}</h2>
                                            
                                            <div className="flex gap-4 mt-3 text-white/60 text-xs">
                                                {isEditing ? (
                                                    <div className="flex gap-2 w-full">
                                                        <input placeholder="Dirección..." className="bg-white/10 rounded px-2 py-1 w-40 outline-none focus:bg-white/20" value={formData.direccion} onChange={e => setFormData({...formData, direccion: e.target.value})}/>
                                                        <input placeholder="Contacto..." className="bg-white/10 rounded px-2 py-1 w-40 outline-none focus:bg-white/20" value={formData.contacto} onChange={e => setFormData({...formData, contacto: e.target.value})}/>
                                                    </div>
                                                ) : (
                                                    <>
                                                        {formData.direccion && <span className="flex items-center gap-1"><MapPin size={12}/> {formData.direccion}</span>}
                                                        {formData.contacto && <span className="flex items-center gap-1"><Phone size={12}/> {formData.contacto}</span>}
                                                    </>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                    <div className="flex gap-3 items-start">
                                        {!isEditing && (
                                            <div className="flex gap-2">
                                                <button onClick={() => setShowMagicPaste(!showMagicPaste)} className="p-3 bg-pink-600/20 rounded-full hover:bg-pink-600/40 transition text-pink-200 border border-pink-500/50 magic-btn" title="Pegado Mágico IA">
                                                    <Sparkles size={20}/>
                                                </button>
                                                <button onClick={() => setIsEditing(true)} className="p-3 bg-white/10 rounded-full hover:bg-white/30 transition text-white border border-white/10" title="Editar">
                                                    <Pencil size={20}/>
                                                </button>
                                            </div>
                                        )}
                                        <button onClick={() => setSelectedInst(null)} className="p-3 bg-white/10 rounded-full hover:bg-red-500/20 transition text-white border border-white/10"><X size={20}/></button>
                                    </div>
                                </div>

                                {/* TABS */}
                                <div className="relative z-10 px-8 pt-4 pb-0 flex items-center gap-2 overflow-x-auto custom-scrollbar border-b border-white/10 bg-black/20">
                                    {formData.careers.map((career, idx) => (
                                        <button 
                                            key={idx}
                                            onClick={() => setCurrentCareerIndex(idx)}
                                            className={`px-4 py-3 text-sm font-bold rounded-t-xl transition-all flex items-center gap-2 border-t border-x ${currentCareerIndex === idx ? 'bg-[#1a1a1a] text-white border-white/20 border-b-[#1a1a1a] translate-y-[1px]' : 'bg-white/5 text-white/40 border-transparent hover:bg-white/10 hover:text-white/70'}`}
                                        >
                                            <GraduationCap size={14}/>
                                            {career.carrera || `Carrera ${idx + 1}`}
                                            {isEditing && formData.careers.length > 1 && (
                                                <span onClick={(e) => removeCareer(e, idx)} className="ml-2 p-1 hover:bg-red-500/50 rounded-full"><X size={10}/></span>
                                            )}
                                        </button>
                                    ))}
                                    {isEditing && (
                                        <button onClick={addNewCareer} className="px-3 py-2 text-xs bg-green-600/20 text-green-400 hover:bg-green-600/40 rounded-lg transition mb-1 ml-2 border border-green-500/30 flex items-center gap-1">
                                            <Plus size={12}/> Nueva Carrera
                                        </button>
                                    )}
                                </div>

                                {/* MAGIC PASTE MODAL */}
                                {showMagicPaste && (
                                    <div className="absolute inset-x-0 top-0 z-50 bg-[#111] border-b border-pink-500/30 p-6 shadow-2xl animate-in slide-in-from-top-10">
                                        <h3 className="text-pink-400 font-bold flex items-center gap-2 mb-2"><Sparkles size={18}/> Pegado Inteligente</h3>
                                        <p className="text-xs text-white/50 mb-3">Pega un mensaje de WhatsApp o mail desordenado. Intentaremos extraer precios y datos automáticamente.</p>
                                        <textarea 
                                            className="w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-pink-500 outline-none h-24"
                                            placeholder="Ej: Hola, la matrícula cuesta $50.000 y la cuota mensual es de $20.000..."
                                            value={magicText}
                                            onChange={(e) => setMagicText(e.target.value)}
                                        />
                                        <div className="flex justify-end gap-2 mt-3">
                                            <button onClick={() => setShowMagicPaste(false)} className="px-4 py-2 text-xs text-white/50 hover:text-white">Cancelar</button>
                                            <button onClick={handleMagicPaste} className="px-4 py-2 bg-pink-600 hover:bg-pink-500 text-white text-xs font-bold rounded-lg shadow-lg shadow-pink-900/20">✨ Analizar y Completar</button>
                                        </div>
                                    </div>
                                )}

                                <div className="relative flex-1 overflow-y-auto custom-scrollbar p-8 bg-[#1a1a1a] z-10">
                                    {!isEditing ? (
                                        <div className="space-y-8">
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 p-6 bg-white/5 rounded-2xl border border-white/10">
                                                <div className="space-y-1">
                                                    <label className="text-xs uppercase font-bold text-white/50 flex items-center gap-2"><GraduationCap size={12}/> Carrera</label>
                                                    <p className="text-xl font-bold text-white">{currentCareer.carrera || 'No especificada'}</p>
                                                </div>
                                                <div className="space-y-1">
                                                    <label className="text-xs uppercase font-bold text-white/50 flex items-center gap-2"><Wifi size={12}/> Modalidad</label>
                                                    <p className="text-lg text-white/90">{currentCareer.modalidad || '-'}</p>
                                                </div>
                                            </div>

                                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                                <div className="space-y-6">
                                                    <h3 className="text-lg font-bold text-white border-b border-white/10 pb-2 flex items-center gap-2"><DollarSign size={18} className="text-emerald-400"/> Costos</h3>
                                                    <div className="space-y-3 bg-black/20 p-4 rounded-xl border border-white/5">
                                                        <div className="flex justify-between border-b border-white/5 pb-2"><span className="text-white/60 text-sm">Matrícula</span><span className="font-mono text-lg font-bold">{currentCareer.matricula ? `$${currentCareer.matricula}` : '-'}</span></div>
                                                        <div className="flex justify-between border-b border-white/5 pb-2"><span className="text-white/60 text-sm">Cuota</span><span className="font-mono text-lg font-bold">{currentCareer.cuota ? `$${currentCareer.cuota}` : '-'}</span></div>
                                                        <div className="flex justify-between border-b border-white/5 pb-2"><span className="text-white/60 text-sm">Cantidad de cuotas</span><span className="font-mono">{currentCareer.cantidadCuotas || '-'}</span></div>
                                                        <div className="flex justify-between"><span className="text-white/60 text-sm">Semestre</span><span className="font-mono">{currentCareer.valorSemestre ? `$${currentCareer.valorSemestre}` : '-'}</span></div>
                                                    </div>
                                                </div>

                                                <div className="space-y-6">
                                                    <h3 className="text-lg font-bold text-white border-b border-white/10 pb-2 flex items-center gap-2"><CreditCard size={18} className="text-blue-400"/> Comercial</h3>
                                                    <div className="space-y-4 text-sm text-white/80">
                                                        <p><strong className="text-white/50 block text-[10px] uppercase tracking-wider">Promociones</strong> {currentCareer.promocion || '-'}</p>
                                                        <p><strong className="text-white/50 block text-[10px] uppercase tracking-wider">Medios de Pago</strong> {currentCareer.mediosPago || '-'}</p>
                                                        <p><strong className="text-white/50 block text-[10px] uppercase tracking-wider">Atención</strong> {currentCareer.atencion || '-'}</p>
                                                    </div>
                                                </div>

                                                <div className="space-y-6">
                                                    <h3 className="text-lg font-bold text-white border-b border-white/10 pb-2 flex items-center gap-2"><Eye size={18} className="text-yellow-400"/> Análisis</h3>
                                                    <div className="space-y-4">
                                                        <div className="bg-emerald-900/20 p-3 rounded-lg border border-emerald-500/20"><p className="text-emerald-400 text-[10px] font-bold mb-1 uppercase">Destacado (+)</p><p className="text-sm">{currentCareer.destacadoPositivo || '-'}</p></div>
                                                        <div className="bg-red-900/20 p-3 rounded-lg border border-red-500/20"><p className="text-red-400 text-[10px] font-bold mb-1 uppercase">Destacado (-)</p><p className="text-sm">{currentCareer.destacadoNegativo || '-'}</p></div>
                                                        <div className="p-3"><p className="text-white/40 text-[10px] font-bold mb-1 uppercase">Observaciones</p><p className="text-sm text-white/70 italic">{currentCareer.observacion || 'Sin observaciones'}</p></div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            {formData.customFields.length > 0 && (
                                                <div className="mt-4 pt-4 border-t border-white/10">
                                                    <h4 className="text-xs font-bold text-white/40 uppercase mb-3">Información Adicional (Global)</h4>
                                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                                        {formData.customFields.map((f, i) => (
                                                            <div key={i} className="bg-white/5 p-2 rounded border border-white/5">
                                                                <span className="block text-[10px] text-white/40 uppercase">{f.label}</span>
                                                                <span className="block text-sm font-medium">{f.value}</span>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    ) : (
                                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
                                            <div className="space-y-6">
                                                <h3 className="text-lg font-bold text-white border-b border-white/10 pb-2 flex items-center gap-2"><FileSignature size={18} className="text-pink-500"/> Datos Carrera</h3>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Nombre Carrera</label><input type="text" className="w-full bg-white/5 border border-white/10 rounded-xl p-3 focus:border-pink-500 outline-none" value={currentCareer.carrera} onChange={e=>updateCareerField('carrera', e.target.value)} /></div>
                                                <div className="grid grid-cols-2 gap-4">
                                                    <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Matrícula ($)</label><div className="relative"><span className="absolute left-3 top-3 text-white/30">$</span><input type="number" className="w-full bg-white/5 border border-white/10 rounded-xl p-3 pl-8 focus:border-pink-500 outline-none" value={currentCareer.matricula} onChange={e=>updateCareerField('matricula', e.target.value)} /></div></div>
                                                    <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Cuota ($)</label><div className="relative"><span className="absolute left-3 top-3 text-white/30">$</span><input type="number" className="w-full bg-white/5 border border-white/10 rounded-xl p-3 pl-8 focus:border-pink-500 outline-none" value={currentCareer.cuota} onChange={e=>updateCareerField('cuota', e.target.value)} /></div></div>
                                                </div>
                                                <div className="bg-white/5 p-4 rounded-xl border border-white/5 grid grid-cols-2 gap-4">
                                                     <div className="space-y-1"><label className="text-[10px] uppercase font-bold text-white/50">Cantidad de cuotas</label><input type="number" className="w-full bg-black/20 rounded-lg p-2 text-sm outline-none" placeholder="#" value={currentCareer.cantidadCuotas} onChange={e=>updateCareerField('cantidadCuotas', e.target.value)} /></div>
                                                     <div className="space-y-1"><label className="text-[10px] uppercase font-bold text-white/50">Semestre (Opc)</label><input type="number" className="w-full bg-black/20 rounded-lg p-2 text-sm outline-none" placeholder="$" value={currentCareer.valorSemestre} onChange={e=>updateCareerField('valorSemestre', e.target.value)} /></div>
                                                </div>
                                            </div>
                                            <div className="space-y-6">
                                                <h3 className="text-lg font-bold text-white border-b border-white/10 pb-2 flex items-center gap-2"><CreditCard size={18} className="text-blue-500"/> Comercial</h3>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Modalidad</label><input type="text" className="w-full bg-white/5 border border-white/10 rounded-xl p-3 focus:border-blue-500 outline-none" value={currentCareer.modalidad} onChange={e=>updateCareerField('modalidad', e.target.value)} /></div>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Promociones</label><input type="text" className="w-full bg-white/5 border border-white/10 rounded-xl p-3 focus:border-blue-500 outline-none" value={currentCareer.promocion} onChange={e=>updateCareerField('promocion', e.target.value)} /></div>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Medios de Pago</label><input type="text" className="w-full bg-white/5 border border-white/10 rounded-xl p-3 focus:border-blue-500 outline-none" value={currentCareer.mediosPago} onChange={e=>updateCareerField('mediosPago', e.target.value)} /></div>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Atención</label><input type="text" className="w-full bg-white/5 border border-white/10 rounded-xl p-3 focus:border-blue-500 outline-none" value={currentCareer.atencion} onChange={e=>updateCareerField('atencion', e.target.value)} /></div>
                                            </div>
                                            <div className="space-y-6">
                                                <h3 className="text-lg font-bold text-white border-b border-white/10 pb-2 flex items-center gap-2"><Eye size={18} className="text-yellow-500"/> Análisis</h3>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-green-400 flex gap-1"><ThumbsUp size={12}/> Destacado (+)</label><textarea rows={2} className="w-full bg-green-500/10 border border-green-500/20 rounded-xl p-3 text-white focus:border-green-500 outline-none resize-none" value={currentCareer.destacadoPositivo} onChange={e=>updateCareerField('destacadoPositivo', e.target.value)} /></div>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-red-400 flex gap-1"><ThumbsDown size={12}/> Destacado (-)</label><textarea rows={2} className="w-full bg-red-500/10 border border-red-500/20 rounded-xl p-3 text-white focus:border-red-500 outline-none resize-none" value={currentCareer.destacadoNegativo} onChange={e=>updateCareerField('destacadoNegativo', e.target.value)} /></div>
                                                <div className="space-y-1"><label className="text-xs uppercase font-bold text-white/50">Observaciones</label><textarea rows={2} className="w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white focus:border-white/30 outline-none resize-none" value={currentCareer.observacion} onChange={e=>updateCareerField('observacion', e.target.value)} /></div>
                                                
                                                <div className="pt-4 border-t border-white/10">
                                                    <label className="text-xs uppercase font-bold text-pink-500 mb-1 block">Tu Nombre (Quedará registrado)</label>
                                                    <div className="relative"><User size={14} className="absolute left-3 top-3 text-white/50"/><input type="text" placeholder="Tu nombre" className="w-full bg-white/10 border border-white/20 rounded-xl p-2 pl-9 text-sm focus:border-pink-500 outline-none" value={formData.responsable} onChange={e=>setFormData({...formData, responsable:e.target.value})} /></div>
                                                </div>
                                                
                                                <div className="mt-4">
                                                    <div className="flex justify-between items-center mb-2"><h4 className="font-bold text-xs text-white/60">EXTRAS (Globales)</h4><button onClick={addField} className="text-[10px] bg-white/10 px-2 py-1 rounded hover:bg-white/20">+ Agregar</button></div>
                                                    <div className="space-y-2">
                                                        {formData.customFields.map((f, i) => (
                                                            <div key={i} className="flex gap-2"><input placeholder="Título" className="bg-white/5 rounded p-1 text-xs w-1/3 outline-none" value={f.label} onChange={e=>updateField(i,'label',e.target.value)}/><input placeholder="Valor" className="bg-white/5 rounded p-1 text-xs w-1/2 outline-none" value={f.value} onChange={e=>updateField(i,'value',e.target.value)}/><button onClick={()=>removeField(i)} className="text-white/20 hover:text-red-500"><Trash2 size={14}/></button></div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>

                                {/* Footer */}
                                <div className="relative p-4 border-t border-white/10 bg-[#0a0a0a] flex justify-between items-center z-10">
                                    <div className="text-xs text-white/30 flex flex-col">
                                        <span>Modificado por: <strong className="text-white/60">{competitorData[selectedInst.name]?.responsable || 'Anónimo'}</strong></span>
                                        <span>Fecha: {competitorData[selectedInst.name]?.lastUpdated ? formatDate(competitorData[selectedInst.name].lastUpdated) : '-'}</span>
                                    </div>
                                    
                                    {isEditing && (
                                        <div className="flex gap-3">
                                            <button onClick={() => setIsEditing(false)} className="px-6 py-2 rounded-xl text-white/60 hover:bg-white/10 transition">Cancelar</button>
                                            <button onClick={handleSave} className="px-6 py-2 rounded-xl bg-white text-black font-bold hover:scale-105 transition shadow-xl flex items-center gap-2"><Save size={18}/> GUARDAR</button>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {isAddingNew && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200">
                            <div className="absolute inset-0 bg-black/80 backdrop-blur-sm" onClick={() => setIsAddingNew(false)}></div>
                            <div className="relative w-full max-w-md bg-[#151515] border border-white/10 rounded-3xl p-8 shadow-2xl">
                                <h2 className="text-2xl font-bold text-white mb-6 flex items-center gap-2"><Plus className="text-pink-500" /> Nueva Competencia</h2>
                                <div className="space-y-4">
                                    <div><label className="text-xs text-white/50 uppercase font-bold ml-1">Nombre</label><input type="text" className="w-full bg-black/30 border border-white/10 rounded-xl p-3 mt-1 text-white focus:border-pink-500 outline-none" value={newInstData.name} onChange={e => setNewInstData({...newInstData, name: e.target.value})} /></div>
                                    <div><label className="text-xs text-white/50 uppercase font-bold ml-1">URL Logo</label><input type="text" className="w-full bg-black/30 border border-white/10 rounded-xl p-3 mt-1 text-white focus:border-pink-500 outline-none" value={newInstData.logo} onChange={e => setNewInstData({...newInstData, logo: e.target.value})} /></div>
                                    <div><label className="text-xs text-white/50 uppercase font-bold ml-1">Color</label><input type="color" className="w-full h-10 bg-transparent border-none cursor-pointer" value={newInstData.color} onChange={e => setNewInstData({...newInstData, color: e.target.value})} /></div>
                                </div>
                                <div className="flex justify-end gap-3 mt-8">
                                    <button onClick={() => setIsAddingNew(false)} className="px-4 py-2 rounded-xl text-white/60 hover:bg-white/5">Cancelar</button>
                                    <button onClick={handleCreate} className="px-6 py-2 rounded-xl bg-gradient-to-r from-pink-600 to-violet-600 text-white font-bold">Crear</button>
                                </div>
                            </div>
                        </div>
                    )}

                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<CompetitorApp />);
    </script>
</body>
</html>
